## 10指针
C语言最高级特性之一：指针。本章包含：

1. 定义简单指针
2. 在常见C表达式中使用指针
3. 是限制向结构体、数组和函数的指针
4. 使用指针创建链表
5. 向指针应用const关键字
6. 将指针作为参数传递给函数

### 10.1指针和间接性
**间接性**是获得某事物的方式并不是直接的。

### 10.2定义指针变量
***是间接运算符，是指向什么类型的指针，&是地址运算符，&x（变量）就是指向x变量的指针。**

声明指针后，可以将指针（&变量）赋给指针，用变量（*指针）赋值给变量。

地址运算符降级，间接运算符升级。

**程序10.1 演示指针**

```c++

```

**程序10.2 更多的指针基础知识**

```c++

```

定义变量之后的情况下只能用

```c++
char *char_pointer;
char_pointer = &c;
```
第二句不能再有*char_pointer。


*char_pointer的改变和对c的直接改变效果是一眼的。

### 10.3在表达式中使用指针

*和&作为运算符优先级高于C中所有二元运算符。

**程序10.3 在表达式中使用指针**

```c++

```

### 10.4使用指针和结构体
使用指针指向结构体，但是**调用结构体成员的时候必须有括号**。

```c++
(*dateptr).day = 12;

dateptr->day = 12;
```
此处可以理解后一种写法为何是更加普遍存在的。

**程序10.4 使用指向结构体的指针**

```c++

```

#### 10.4.1包含指针的结构体
更改指针也是更改变量本身的值。

**程序10.5 使用包含指针的结构体**

```c++

```


#### 10.4.2链表
将以上两个概念组合在一起，可以形成链表、双链表和树。

```c++
struct entry
{
    int velue;
    struct entry *next;
}
```
第二个成员指向一个同类型的结构。

**程序10.6 使用链表**

```c++

```

此处要注意，当指针作为成员的时候，调用可以直接指向一个元素的地址。

将结构体变量的指针赋值给另一指针，则可以删除一个元素，主要是n1不再指向n2。

插入的时候完全可以顺序指针指向各元素指针，之前的指针指向新元素的地址。

开发链表函数之前：

1. 在遍历之前还需要制定一个指向列表的指针。
2. 在要考虑将链表最后设定空指针。


**空指针**是用常数值0指定的指针。

```c++
n3.next = (struct entry *) 0;
```

**程序10.7 遍历链表**

```c++

```

**动态内存分配机制**是让系统为每个新列表留出内存空间，并在程序执行时将它链接在列表中。

### 10.5关键字const和指针

指针有两点需要考虑：

1. 指针能否被修改
2. 指针指向的值能否被修改

```c++
char * const charptr = &c;
charptr = &d; //无效
```
可以看到此时指针只能指向&c。

```c++
char c = 'X';
const char * charptr = &c;
*charptr = 'Y';//无效
```
可以看到此时指针指向的值不能被修改


### 10.6指针和函数
指针本身作为参数只能传值，如果指针引用数据元素是可以被修改的。

**程序10.8 使用指针和函数**

```c++

```

**程序10.9 用指针交换值**

```c++

```

使用指针可以方便的返回两个整数值，其直接作用效果如同传地址，并且可以用传地址的方式视为传指针。

**程序10.10 从函数中返回指针**


```c++

```

此处可以观察到利用指针循链寻找得到具体值的函数和过程。


链表虽然增删方便，查找却困难，可以用树满足所有优点，此外也可以用哈希表。


### 10.7指针和数组

定义一个指向数组元素的指针，类型必然跟数组元素类型相同。

```c++
char *textptr;
valuesptr = values;
```

此处指向字符数组values的指针。

或者等价为:

```c++
valuesptr = &values[0];
```

1. 此处valuesptr总可以自增自减
2. 指针加索引值数字总可以得到指向索引值的指针

**程序10.11 使用指向数组的指针**

```c++

```

#### 10.7.1稍许离题：程序优化

1. 其实上个程序完全没必要有局部变量，只是为了循环阶段减少应有的计算进行优化。
2. 使用指针接触程序总快于索引，尤其需要大量进行依次计算的时候。

#### 10.7.2是数组还是指针？

此时形参作为数组或者指针都是可以的。

**程序10.12 对数组中元素进行求和**

```c++

```

指针的递增当然只改变指针本身指向的位置。


#### 10.7.3指向字符串的指针

写出一个复制字符串的函数。

**程序10.13 copystring()的指针版本**

```c++

```

#### 10.7.4常量字符串和指针

字符指针能够指向一个数组并且赋值，但是明显不能用全数组进行赋值。


也可以建立一个字符指针的数组，包含的都是字符指针指向各个量。

#### 10.7.5递增和递减运算符回顾

对于后递增（i++）注意到是先赋值而后自增就是了。**与循环中前后递增的效果无关，只与效率有关。**

对指针也可以进行前后递增，并不需要加括号，但是加上更明白。

此时有一个新版本的内容可以继续进行理解。注意赋值此时存在于缓存区，这是理解递增和赋值关系的关键。

**程序10.14 copystring()函数的修订版本**

```c++

```

### 10.8指针操作

```c++
p = &x[99];
n = p - x;
```
此处求得n和p之间的元素个数，为99。

**程序10.15 用指针求字符串长度**

```c++

```


### 10.9指向函数的指针

```c++
int lookup(void);
int (*fnptr)(void);
fnptr = lookup;

entry = fnptr();
```
由以上例子可以看到具体的声明函数，声明函数指针，将函数指针指向函数（不带参数表的函数如同不带索引的数组一样当做指针），最后可以连带参数调用将值赋值给entry。

常见应用：

1. qsort之类的函数有函数指针作为参数
2. 将函数指针存储在数组中调用函数

**计划表**是将函数指针存储在数组中，处理不同的函数命令。

### 10.10指针和内存地址

**地址**是计算机每个内存单元的编号。


此处可以知道&作为地址运算符能够将值的地址提取出来，而*能够存储的是一个值的地址。


