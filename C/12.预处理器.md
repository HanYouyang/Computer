## 12预处理器

**预处理器**是C编译过程的一部分，它识别出可能散布在整个C程序中的特殊语句。

**预处理器语句**是以#开头，并且位于代码行中第一非空字符的语句。

本章包含：

1. 使用#define语句创建自己的常量和宏
2. 使用#include语句生成自己的库文件
3. 使用#ifdef、#endif、#else和#ifndef等条件语句编写更强大的程序

### 12.1#define语句

```c++
#define YES 1
```
此处定义应在引用之前，没有等号，没有分号结束，注意此处得到的是一个名为YES的**常量**，定义出来的名字为全大写或者之前加上小写k。

**本身类似查找和替换。**


```c++
char *charptr = "YES";
```
此处指针仍然指向YES而非1。

**程序12.1 介绍#define语句**

```c++

```

通常程序员会使定义名字NULL来表示空指针。

```c++
#define NULL 0
while (listptr != NULL)
{
    ...
}
```
此处可以判断指针listptr是否为空指针。


**程序12.2 再谈定义的适用**

```c++

```


#### 12.1.1程序可扩展性

定义和更该数组时候指明元素个数，可以通过开头定义一个数组最常用的值作为数量。

```c++
#define MAX_DATAVALUE 100
float datavalue[MAX_DATAVALUE];
```

#### 12.1.2程序可移植性

如果此时的代码根据机器不同而有所变化，那么则应该考虑方便修改，也就是声明一个预处理器语句在开头位置。

#### 12.1.3更高级的定义类型

记住本身类似查找和替换，那么后面加上什么都是立即替换，加上表达式可以，加上分号则也都是分号就不可以。

但是尽量不要替代基础语法，不然会被认为是一种较差的程序设计实践。

也可以引用另一个定义值。

引用非常长的表达式的时候就需要考虑需要加上\来另起一行。


**参数与宏**

当表达式被定义成一个数值的时候，应该考虑用一个参数形成替代，从而成为一个可以替换参数的函数类似的表达式。

**宏**是定义，更是拥有一个或多个参数的定义。

宏比函数的区别：

1. 宏不需要关心参数类型
2. 宏的内存开销较大
3. 宏避免了时间开销
4. 宏只能替换字面文本，最终代入表达式可能会有所区别（涉及到符号运算优先级），除非表达式都加好括号


**可变数目的宏参数**

参数括号中是三个点(...)，列表中的其余参数有特定标识符__VA_ARGS__作为整体引用。

#### 12.1.4#运算符

可以在宏的参数前加#获得常量字符串。

#### 12.1.5##运算符

可以组合##前后的两个字符成一个字符。

### 12.2#include语句

其实可以写入文件为.h的头文件，并且用#include在程序开头引用。

```c++
#include "metric.h"
#include <metric.h>
```
后者其实比前者的头文件搜索范围更广

**程序12.3 使用#include语句**

```c++

```

好的头文件会包含程序的几乎一切定义，此外还是可以嵌套的。

#### 12.2.1系统包含文件

<stddef.h>包含空指针

<limits.h>包含整型数据类型的大小

<float.h>包含浮点数的极值


### 12.3条件编译

**条件编译**是创建一个能在不同计算机系统上编译运行的程序。


